# Specification

## 顶级规格属性

| Property    |                             Type                             | Description                                                  |
| :---------- | :----------------------------------------------------------: | :----------------------------------------------------------- |
| $schema     |      [URL](https://vega.github.io/vega/docs/types/#URL)      | Vega模式的URL                                                |
| description |   [String](https://vega.github.io/vega/docs/types/#String)   | 可视化的文本描述。在版本≥5.10中，描述确定了一个Vega视图的容器元素的aria-label属性。 |
| background  | [Color](https://vega.github.io/vega/docs/types/#Color) \| [Signal](https://vega.github.io/vega/docs/types/#Signal) | 整个视图的背景颜色(默认为透明)。如果信号值≥5.10，则提供的表达式用作底层背景信号定义的更新属性。 |
| width       | [Number](https://vega.github.io/vega/docs/types/#Number) \| [Signal](https://vega.github.io/vega/docs/types/#Signal) | 数据矩形的宽度(以像素为单位)。如果信号值≥5.10，提供的表达式用作基础width信号定义的update属性。 |
| height      | [Number](https://vega.github.io/vega/docs/types/#Number) \| [Signal](https://vega.github.io/vega/docs/types/#Signal) | 数据矩形的宽度(以像素为单位)。如果信号值≥5.10，提供的表达式用作基础height信号定义的update属性。 |
| padding     | [Number](https://vega.github.io/vega/docs/types/#Number) \| [Object](https://vega.github.io/vega/docs/types/#Object) \| [Signal](https://vega.github.io/vega/docs/types/#Signal) | 要在可视化周围添加的像素填充。如果是数字，指定所有边的填充。如果是一个对象，其格式应该是 `{"left": 5, "top": 5, "right": 5, "bottom": 5}`.自动调整大小布局完成后应用填充。如果信号值≥5.10，则提供的表达式用作基础填充信号定义的更新属性，其值应为填充对象或数字。 |
| autosize    | [String](https://vega.github.io/vega/docs/types/#String) \| [Autosize](https://vega.github.io/vega/docs/specification/#autosize) \| [Signal](https://vega.github.io/vega/docs/types/#Signal) | 设置应如何确定可视化大小。如果是字符串，应该是pad(默认)、fit、fit-x、fit-y或none中的一个。对象值还可以为内容调整大小和自动调整大小指定参数。有关更多信息，请参见下面的autosize部分。如果信号值≥5.10，则提供的表达式用作基础autosize信号定义的更新属性，并应计算为一个完整的autosize对象。 |
| config      |      [Config](https://vega.github.io/vega/docs/config)       | 带有marks、axes和legends默认值的配置设置。                   |
| signals     |    [Signal](https://vega.github.io/vega/docs/signals)[ ]     | 信号是参数化可视化的动态变量。                               |
| data        |       [Data](https://vega.github.io/vega/docs/data)[ ]       | 数据集定义和转换定义要加载的数据以及如何处理这些数据。       |
| scales      |     [Scale](https://vega.github.io/vega/docs/scales)[ ]      | 将数据值(数字、日期、类别等)映射为可视值(像素、颜色、大小)。 |
| projections | [Projection](https://vega.github.io/vega/docs/projections)[ ] | 地图投影(经度，纬度)对投影(x, y)坐标。                       |
| axes        |       [Axis](https://vega.github.io/vega/docs/axes)[ ]       | 坐标轴可视化空间尺度映射。                                   |
| legends     |    [Legend](https://vega.github.io/vega/docs/legends)[ ]     | 图例为颜色、形状和大小等可视值可视化比例映射。               |
| title       |       [Title](https://vega.github.io/vega/docs/title)        | 描述可视化的标题文本。                                       |
| marks       |      [Mark](https://vega.github.io/vega/docs/marks)[ ]       | 图形标记使用几何原语(如矩形、直线和绘图符号)对数据进行可视化编码。 |
| encode      |   [Encode](https://vega.github.io/vega/docs/marks/#encode)   | 用于表示图表数据矩形的顶级组标记的可视属性的编码指令。例如，这可以用于设置绘图区域的背景填充颜色，而不是整个视图。 |
| usermeta    |   [Object](https://vega.github.io/vega/docs/types/#Object)   | 可选的元数据将被Vega解析器忽略。                             |

## Autosize

| Name     |                            Type                            | Description                                                  |
| :------- | :--------------------------------------------------------: | :----------------------------------------------------------- |
| type     |  [String](https://vega.github.io/vega/docs/types/#String)  | ***必需的***。分级格式类型。有 `"pad"` (default), `"fit"`, `"fit-x"`, `"fit-y"`, 或 `"none"`.有关每种类型的描述，请参阅autosize类型文档 |
| resize   | [Boolean](https://vega.github.io/vega/docs/types/#Boolean) | 一个布尔标志，指示是否在每次视图更新时重新计算autosize布局。默认值(false)导致布局在初始化时执行一次，并响应高度和宽度或信号的更改(有关大小调整逻辑的更多信息，请参见[此处](https://github.com/vega/vega/blob/master/packages/vega-view/src/size.js))。否则，布局就会保持稳定。要从外部强制调整大小，请使用[View.resize](https://vega.github.io/vega/docs/api/view/#view_resize)API方法。 |
| contains |  [String](https://vega.github.io/vega/docs/types/#String)  | 确定应如何执行大小计算，content(默认)或padding之一。默认设置(content)将宽度和高度设置解释为数据矩形(绘图)的尺寸，然后向其添加填充。相反，padding设置包括视图大小计算中的填充，这样，宽度和高度设置指示视图的总体预期大小。 |

## Autosize Types

Vega可视化的总大小可以由多个因素决定:指定的宽度、高度和填充值，以及轴、图例和标题等内容。支持不同的用例，Vega提供了三种不同的autosize类型来决定一个可视化视图的最终大小:

- `none`: 不执行自动调整大小。总的可视化大小仅由提供的宽度、高度和填充值决定。例如，默认情况下，总宽度计算为width + padding.left + padding.right。本区域之外的任何内容都将被剪切。如果*autosize.contains* 被设置为“padding”，总宽度改为简单的宽度。
- `pad`: 自动增加视图的大小，以便所有可视化内容都是可见的。这是默认的autosize设置，确保包含了轴、图例和其他超出正常宽度和高度的项。总大小通常会超过指定的宽度、高度和填充。
- `fit`: 自动调整布局，试图强制整个可视化大小适应给定的宽度、高度和填充值。这个设置使绘图区域变得更小，以适应坐标轴、图例和标题。因此，宽度和高度信号的值可以改变来修改布局。虽然fit方法对许多情节有效，但它不能总是确保所有内容都是可见的。例如，如果仅轴和图例就需要比指定的宽度和高度更多的空间，那么一些内容将被剪切。类似于none，默认情况下，总宽度为width + padding.left+padding.right，相对于原始的、未修改的宽度值。如果autosize.contains被设置为“padding”，总宽度将改为原来的宽度。
- `fit-x`: 与fit相似，除了宽度(x轴)调整为适合给定的尺寸。视图高度自动调整大小，就像设置为pad一样。≥3.1
- `fit-y`: 与fit相似，只是只有高度(y轴)被调整为适合给定的尺寸。视图宽度自动调整大小，就像设置为pad一样。≥3.1

# Config

Config对象定义默认的可视值来设置可视化的主题。

Vega解析器接受一个JSON配置文件，该文件定义了各种可视化编码选项的默认设置。不同的配置文件可以用于具有自定义外观的“主题”图表。配置文件就是一个JSON对象，它具有一组按类型分组的命名属性。要在解析时提供配置文件，只需向parse方法传递一个附加参数:

```js
var runtime = vega.parse(spec, config);
```

此外，Vega JSON规范可能包含一个单一的顶级配置属性来覆盖任何配置设置。规范本身提供的任何配置都优先于传递给解析器的外部配置。

例如，这个Vega语法默认包括浅灰色轴网格线:

```js
{
  "width": 500,
  "height": 200,
  "config": {
    "axis": {
      "grid": true,
      "gridColor": "#dedede"
    }
  },
  ...
}
```

## Config Reference

### View Properties

在配置对象的顶级范围中定义的属性。

| Property    |                             Type                             | Description                                                  |
| :---------- | :----------------------------------------------------------: | :----------------------------------------------------------- |
| autosize    | [String](https://vega.github.io/vega/docs/types/#String) \| [Object](https://vega.github.io/vega/docs/types/#Object) \| [Signal](https://vega.github.io/vega/docs/types/#Signal) | 默认的自动调整大小设置。有效的字符串值是“pad”、“fit”或“none”。有关更多信息，请参见autosize文档。信号支持可在版本≥5.10。 |
| background  | [Color](https://vega.github.io/vega/docs/types/#Color) \| [Signal](https://vega.github.io/vega/docs/types/#Signal) | 视图组件的背景颜色，若null为透明。信号支持可在版本≥5.10。    |
| description |   [String](https://vega.github.io/vega/docs/types/#String)   | 可视化的默认文本描述。描述确定了一个Vega视图的容器元素的aria-label属性。≥5.10 |
| padding     | [Number](https://vega.github.io/vega/docs/types/#Number) \| [Object](https://vega.github.io/vega/docs/types/#Object) \| [Signal](https://vega.github.io/vega/docs/types/#Signal) | 要在可视化周围添加的像素填充。如果是数字，指定所有边的填充。如果是一个对象，其格式应该是`{"left": 5, "top": 5, "right": 5, "bottom": 5}`。信号支持可在版本≥5.10。 |
| width       | [Number](https://vega.github.io/vega/docs/types/#Number) \| [Signal](https://vega.github.io/vega/docs/types/#Signal) | 数据矩形的宽度(以像素为单位)。≥5.10                          |
| height      | [Number](https://vega.github.io/vega/docs/types/#Number) \| [Signal](https://vega.github.io/vega/docs/types/#Signal) | 数据矩形的高度(以像素为单位)。≥5.10                          |
| group       |   [Object](https://vega.github.io/vega/docs/types/#Object)   | 表示图表数据矩形的顶级组标记的默认属性。此对象的有效属性是标记属性，如`"fill"`, `"stroke"` 和 `"strokeWidth"`。 |
| lineBreak   | [String](https://vega.github.io/vega/docs/types/#String) \| [Signal](https://vega.github.io/vega/docs/types/#Signal) | 分隔符， 例如换行符，在换行符上将文本字符串分成多行。此属性为文本标记提供一个全局默认值，该默认值由标记或样式配置设置以及lineBreak标记编码通道覆盖。如果是信号值，则字符串或正则表达式(regexp)值都是有效的。≥5.10 |

##### 用法

设置默认视图背景和图表绘制区域背景颜色:

```js
{
  "background": "white",
  "group": {
    "fill": "#dedede"
  }
}
```

### Event Properties

事件处理配置的属性，在"events"属性块中定义。

| Property |                             Type                             | Description                                                  |
| :------- | :----------------------------------------------------------: | :----------------------------------------------------------- |
| bind     |   [String](https://vega.github.io/vega/docs/types/#String)   | 用于将输入DOM元素绑定到信号的配置控件。可用的选项有“any”(默认情况下，允许所有绑定)、“container”(仅对所有绑定使用视图容器DOM元素，禁止使用每个绑定选择器)和“none”(禁止所有输入绑定)。≥5.5 |
| defaults |   [Object](https://vega.github.io/vega/docs/types/#Object)   | 一个对象，该对象描述源自Vega视图的哪些事件应该通过调用该事件来抑制其默认event.preventDefault方法。默认对象应该有一个单独的属性:“prevent”(表示应该禁止哪些事件的默认行为)或“allow”(仅表示应该允许哪些事件的默认行为)。此属性接受布尔值(用于防止/允许所有事件)或事件类型字符串数组。 |
| selector | [Boolean](https://vega.github.io/vega/docs/types/#Boolean) \| [String](https://vega.github.io/vega/docs/types/#String)[ ] | 使用CSS选择器指定的外部源的事件监听器的配置控件。如果一个布尔值true(默认值)允许选择器事件监听器，false则不允许所有选择器事件。如果是字符串数组，则条目指定一个允许事件类型(如“mousemove”或“wheel”)的白名单。≥5.5 |
| timer    |  [Boolean](https://vega.github.io/vega/docs/types/#Boolean)  | 用于“计时器”源的事件监听器的配置控件。允许计时器事件监听器为true(默认值)，不允许计时器事件为false。≥5.5 |
| view     | [Boolean](https://vega.github.io/vega/docs/types/#Boolean) \| [String](https://vega.github.io/vega/docs/types/#String)[ ] | 用于Vega“视图”源的事件监听器的配置控制。如果布尔值true(默认值)允许视图事件监听器，false则不允许所有视图事件。如果是字符串数组，则条目指定一个允许事件类型(如“mousemove”或“wheel”)的白名单。≥5.5 |
| window   | [Boolean](https://vega.github.io/vega/docs/types/#Boolean) \| [String](https://vega.github.io/vega/docs/types/#String)[ ] | 用于浏览器“窗口”源的事件监听器的配置控件。如果布尔值true(默认值)允许窗口事件监听器，false则不允许所有窗口事件。如果是字符串数组，则条目指定一个允许事件类型(如“mousemove”或“wheel”)的白名单。≥5.5 |

##### 用法

要禁用事件监听器的外部DOM元素指定的CSS选择器和只允许鼠标移动和鼠标向上事件的浏览器窗口对象:

```js
"events": {
  "selector": false,
  "window": ["mousemove", "mouseup"]
}
```

在一个View视图里阻止所有事件源的默认行为:

```js
"events": {
  "defaults": {
    "prevent": true
  }
}
```

在一个View视图里阻止所有事件源的默认行为,除了`wheel` 事件：

```js
"events": {
  "defaults": {
    "allow": ["wheel"]
  }
}
```

### Mark Properties

为每个标记类型定义默认属性值的属性。这些属性是在块中定义的，其名称与有效的标记类型相匹配(例如，`“area”`、`“line”`、`“rect”`)。每个块中的有效属性由合法标记属性(例如，`"fill"`,` "stroke"`, `"size"`, `"font"`)组成。可以使用“mark”属性设置所有标记类型的全局缺省值。

**重要的限制:**

* 只有当“填充”和“描边”都没有在Vega规范中定义时，才会应用默认的填充或描边颜色。

* 使用顶级“mark”属性设置的缺省值将被为更特定的标记类型(例如，“rect”)定义的任何缺省值覆盖。Vega的内置配置包括许多特定标记类型的默认填充色或笔划色，这些颜色将优先于仅在顶级“mark”上设置的新填充色或笔划色。

##### 用法

要设置symbol标记的默认填充颜色和大小:

```js
{
  "symbol": {
    "fill": "steelblue",
    "size": 64
  }
}
```

为所有标记类型设置一个全局不透明度值:

```js
{
  "mark": {
    "opacity": 0.8
  }
}
```

### Style Properties

除了上面的默认标记属性外，还可以使用配置中的style块下定义的命名样式进一步定制默认值。然后可以通过在标记定义中包含`style`指令来调用样式。

例如，为名为“square”的符号标记设置默认形状和笔划宽度:

```js
"style": {
  "square": {
    "shape": "square",
    "strokeWidth": 2
  }
}
```

除了自定义样式名，Vega还包括以下内置的样式名:

- `guide-label`: styles for axis and legend labels
- `guide-title`: styles for axis and legend titles
- `group-title`: styles for chart and header titles

样式设置优先于默认的标记设置，但是被下面描述的轴、图例和标题属性覆盖。

### Axis Properties

定义轴的默认设置的属性。这些属性是在配置对象的“axis”属性下定义的，在这种情况下，设置适用于所有轴。

额外的属性块可以根据方向(“axisX”、“axisY”、“axisLeft”、“axisTop”等)或带尺度类型(“axisBand”)针对更具体的轴类型。例如，在“axisBand”属性下定义的属性只适用于可视化“band”尺度的轴。如果多个轴配置块应用于单个轴，基于类型的选项优先于基于方向的选项，而基于方向的选项又优先于一般选项。

| Property         |                             Type                             | Description                                                  |
| :--------------- | :----------------------------------------------------------: | :----------------------------------------------------------- |
| bandPosition     |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 一个插值分式，表示在“band”尺度中，轴刻度的位置。0个位置的值在其带的左边缘处标记。0.5的值在带的中间放置刻度。 |
| domain           |  [Boolean](https://vega.github.io/vega/docs/types/#Boolean)  | 布尔标志，指示是否默认包含轴域线。                           |
| domainColor      |    [Color](https://vega.github.io/vega/docs/types/#Color)    | 轴域线的颜色。                                               |
| domainDash       | [Number](https://vega.github.io/vega/docs/types/#Number)[ ]  | 轴域线的描边(实线为[])。≥5.0                                 |
| domainDashOffset |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 用于启动域dash数组的像素偏移量。≥5.0                         |
| domainOpacity    |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴域线的不透明度。≥4.1                                       |
| domainWidth      |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴域线的笔画宽度。                                           |
| grid             |  [Boolean](https://vega.github.io/vega/docs/types/#Boolean)  | 布尔标志，指示默认情况下是否应该包括轴网格线。               |
| gridColor        |    [Color](https://vega.github.io/vega/docs/types/#Color)    | 轴线网格线的颜色。                                           |
| gridDash         | [Number](https://vega.github.io/vega/docs/types/#Number)[ ]  | 轴线网格线的描边(实线为[])。                                 |
| gridDashOffset   |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 用于启动网格虚线阵列的像素偏移。≥5.0                         |
| gridOpacity      |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴网格线的不透明度。                                         |
| gridWidth        |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴线网格线的笔画宽度。                                       |
| labels           |  [Boolean](https://vega.github.io/vega/docs/types/#Boolean)  | 布尔标志，指示默认情况下是否应该包括轴标记。                 |
| labelAlign       |   [String](https://vega.github.io/vega/docs/types/#String)   | 轴标记标签的水平文本对齐方式，覆盖轴方向的默认设置。         |
| labelAngle       |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴的角度标记标签。                                           |
| labelBaseline    |   [String](https://vega.github.io/vega/docs/types/#String)   | 轴刻度标签的垂直文本基线，覆盖轴方向的默认设置。             |
| labelBound       | [Boolean](https://vega.github.io/vega/docs/types/#Boolean) \| [Number](https://vega.github.io/vega/docs/types/#Number) | 布尔标记或像素公差值，用于删除超出轴范围的标签。             |
| labelColor       |    [Color](https://vega.github.io/vega/docs/types/#Color)    | 文本颜色的轴标记标签。                                       |
| labelFlush       | [Boolean](https://vega.github.io/vega/docs/types/#Boolean) \| [Number](https://vega.github.io/vega/docs/types/#Number) | 布尔标志或像素距离阈值，用于执行轴标签的“flush”布局。 对于x轴，“flush”将左对齐最左边的标签(如果距离轴开始的距离阈值以内)，同样右对齐最右边的标签。如果为真，则使用1的像素公差。 |
| labelFlushOffset |   [Number](https://vega.github.io/vega/docs/types/#Number)   | flush-adjusted标签的像素偏移量(默认为0)。                    |
| labelFont        |   [String](https://vega.github.io/vega/docs/types/#String)   | 轴标记标签的字体名称。                                       |
| labelFontSize    |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴标记标签的字体大小。                                       |
| labelFontStyle   |   [String](https://vega.github.io/vega/docs/types/#String)   | 轴标记标签的字体样式(例如，正常或斜体)。(e.g., `normal` or `italic`). ≥ 5.0 |
| labelFontWeight  | [String](https://vega.github.io/vega/docs/types/#String) \| [Number](https://vega.github.io/vega/docs/types/#Number) | 轴标记标签的字体粗细。                                       |
| labelLimit       |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴标记标签的最大允许长度(以像素为单位)。                     |
| labelLineHeight  |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 多行标签文本的行高(以像素为单位)。≥5.10                      |
| labelOffset      |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 除了tickOffset之外，还可以应用于标签的位置偏移(以像素为单位)。≥5.10 |
| labelOpacity     |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴标记标签的不透明度。                                       |
| labelOverlap     | [Boolean](https://vega.github.io/vega/docs/types/#Boolean) \| [String](https://vega.github.io/vega/docs/types/#String) | 用于解决轴标签重叠的策略。如果为假，则不尝试减少重叠。如果为真或“parity”，则使用删除所有其他标签的策略(这对于标准线性轴很有效)。如果“greedy”，则执行标签的线性扫描，删除与最后一个可见标签重叠的任何标签(这通常更适合对数缩放轴)。 |
| labelSeparation  |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 标签边界框之间的最小距离，使它们被认为是不重叠的(默认为0)。如果没有启用*labelOverlap*分辨率，则忽略此属性。≥5.0 |
| labelPadding     |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 在轴刻度和刻度标签之间填充像素。                             |
| maxExtent        |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴刻度和标签应使用的最大像素范围。这决定了轴标题的最大偏移量。 |
| minExtent        |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴刻度和标签应使用的最小像素范围。这决定了轴标题的最小偏移量。 |
| ticks            |  [Boolean](https://vega.github.io/vega/docs/types/#Boolean)  | 布尔标志，指示是否默认包含轴标记。                           |
| tickBand         |   [String](https://vega.github.io/vega/docs/types/#String)   | 指示要与band缩放一起使用的刻度样式的类型。“center”(默认)在带间隔的中间，“extent”放置在带范围内的刻度(间隔边界)。如果指定，此属性可以覆盖 `bandPosition`, `tickExtra`, 和 `tickOffset`. ≥ 5.8 |
| tickColor        |    [Color](https://vega.github.io/vega/docs/types/#Color)    | 轴的颜色刻度。                                               |
| tickDash         | [Number](https://vega.github.io/vega/docs/types/#Number)[ ]  | 轴的划线标记(实线为[])。≥5.0                                 |
| tickDashOffset   |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 用于启动标记dash数组的像素偏移量。≥5.0                       |
| tickExtra        |  [Boolean](https://vega.github.io/vega/docs/types/#Boolean)  | 布尔标志，指示是否应该为轴的初始位置添加额外的轴标记。这个标志对于band缩放的样式轴很有用，比如刻度被放置在带的边界上，而不是在带的中间。与“bandPosition”一起使用:1和轴“padding”值0。 |
| tickOffset       |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 以像素为单位的位置偏移量可应用于刻度、标签和网格线。         |
| tickOpacity      |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴刻度的不透明度。 ≥ 4.1                                     |
| tickRound        |  [Boolean](https://vega.github.io/vega/docs/types/#Boolean)  | 布尔标志，指示像素位置值是否应该四舍五入为最接近的整数。     |
| tickSize         |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 尺寸，或长度，以像素为单位的轴刻度。                         |
| tickWidth        |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴刻度的宽度(以像素为单位)。                                 |
| titleAlign       |   [String](https://vega.github.io/vega/docs/types/#String)   | 轴标题的水平文本对齐。`"left"`, `"center"`, or `"right"`的组合。如果指定，此值将覆盖基于titleAnchor值的自动对齐。 |
| titleAnchor      |   [String](https://vega.github.io/vega/docs/types/#String)   | 放置轴标题的锚点位置。一个`"start"`, `"middle"`, `"end"`, or `null`(默认，为自动决定)。例如，使用`"bottom"`的定向，这些锚点位置将映射到左对齐、中对齐或右对齐的标题。锚点是相对于轴标度范围确定的。 |
| titleAngle       |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴标题的角度。                                               |
| titleBaseline    |   [String](https://vega.github.io/vega/docs/types/#String)   | 轴标题的垂直文本基线。                                       |
| titleColor       |    [Color](https://vega.github.io/vega/docs/types/#Color)    | 轴标题的文本颜色。                                           |
| titleFont        |   [String](https://vega.github.io/vega/docs/types/#String)   | 轴标题的字体名称。                                           |
| titleFontSize    |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴标题的字体大小。                                           |
| titleFontStyle   |   [String](https://vega.github.io/vega/docs/types/#String)   | 轴标题的字体样式(例如，正常或斜体)。≥5.0 (e.g., `normal` or `italic`). |
| titleFontWeight  | [String](https://vega.github.io/vega/docs/types/#String) \| [Number](https://vega.github.io/vega/docs/types/#Number) | 轴标题的字体粗细。                                           |
| titleLimit       |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴标题的最大允许长度(以像素为单位)。                         |
| titleLineHeight  |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 多行标题文本的行高(以像素为单位)。≥5.7                       |
| titleOpacity     |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴标题的不透明。≥4.1                                         |
| titlePadding     |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 在轴标记标签和标题之间填充像素。                             |
| titleX           |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴标题相对于轴组的x坐标。                                    |
| titleY           |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 轴标题相对于轴组的y坐标。                                    |
| translate        |   [Number](https://vega.github.io/vega/docs/types/#Number)   | 坐标轴布局的坐标空间平移偏移量。在默认情况下，轴在x和y坐标中都被平移0.5像素的偏移量，以便使描边线与像素网格对齐。然而，对于矢量图形输出，这些特定于像素的调整可能是不受欢迎的，在这种情况下，可以更改translate(例如，为零)。≥5.8 |

##### 用法

```js
{
  "axis": {
    "labelColor": "#ccc"
  },
  "axisBottom": {
    "labelAngle": -90
  }
}
```

### Legend Properties

定义lengend默认设置的属性。这些属性是在配置对象中的“legend”属性下定义的。

| Property              |                             Type                             | Description                                                  |
| :-------------------- | :----------------------------------------------------------: | :----------------------------------------------------------- |
| clipHeight            |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The height in pixels to clip symbol legend entries and limit their size. |
| columns               |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The number of columns in which to arrange symbol legend entries. A value of `0` or lower indicates a single row with one column per entry. |
| columnPadding         |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The horizontal padding in pixels between symbol legend entries. |
| cornerRadius          |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Corner radius for the full legend.                           |
| fillColor             |    [Color](https://vega.github.io/vega/docs/types/#Color)    | Background fill color for the full legend.                   |
| gradientDirection     |   [String](https://vega.github.io/vega/docs/types/#String)   | The default direction (`"horizontal"` or `"vertical"`) for gradient legends. |
| gradientLength        |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The length in pixels of the primary axis of a color gradient. This value corresponds to the height of a vertical gradient or the width of a horizontal gradient. |
| gradientThickness     |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The thickness in pixels of the color gradient. This value corresponds to the width of a vertical gradient or the height of a horizontal gradient. |
| gradientWidth         |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Deprecated, use *gradientLength* instead. If *gradientLength* is not defined, this value will be used instead. |
| gradientHeight        |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Deprecated, use *gradientThickness* instead. If *gradientThickness* is not defined, this value will be used instead. |
| gradientStrokeColor   |    [Color](https://vega.github.io/vega/docs/types/#Color)    | Stroke color for color ramp gradient borders.                |
| gradientStrokeWidth   |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Stroke width for color ramp gradient borders.                |
| gradientLabelLimit    |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The maximum allowed length in pixels of color ramp gradient labels. |
| gradientLabelOffset   |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Vertical offset in pixels for color ramp gradient labels.    |
| gradientOpacity       |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Opacity of color ramp gradient. ≥ 4.1                        |
| gridAlign             |   [String](https://vega.github.io/vega/docs/types/#String)   | The alignment to apply to symbol legends rows and columns. The supported string values are `all`, `each` (the default), and `none`. For more information, see the [grid layout documentation](https://vega.github.io/vega/docs/layout). |
| labelAlign            |   [String](https://vega.github.io/vega/docs/types/#String)   | Horizontal text alignment of legend labels.                  |
| labelBaseline         |   [String](https://vega.github.io/vega/docs/types/#String)   | Vertical text baseline of legend labels.                     |
| labelColor            |    [Color](https://vega.github.io/vega/docs/types/#Color)    | Text color of legend labels.                                 |
| labelFont             |   [String](https://vega.github.io/vega/docs/types/#String)   | Font name of legend labels.                                  |
| labelFontSize         |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Font size in pixels of legend labels.                        |
| labelFontStyle        |   [String](https://vega.github.io/vega/docs/types/#String)   | Font style of legend labels (e.g., `normal` or `italic`). ≥ 5.0 |
| labelFontWeight       | [String](https://vega.github.io/vega/docs/types/#String) \| [Number](https://vega.github.io/vega/docs/types/#Number) | Font weight of legend labels.                                |
| labelLimit            |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The maximum allowed length in pixels of legend labels.       |
| labelOffset           |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Horizontal offset in pixels between legend symbols and labels. |
| labelOpacity          |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Opacity of legend labels. ≥ 4.1                              |
| labelOverlap          | [Boolean](https://vega.github.io/vega/docs/types/#Boolean) \| [String](https://vega.github.io/vega/docs/types/#String) | The strategy to use for resolving overlap of labels in gradient legends. If `false`, no overlap reduction is attempted. If set to `true` (default) or `"parity"`, a strategy of removing every other label is used. If set to `"greedy"`, a linear scan of the labels is performed, removing any label that overlaps with the last visible label. |
| labelSeparation       |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The minimum separation that must be between label bounding boxes for them to be considered non-overlapping (default `0`). This property is ignored if *labelOverlap* resolution is not enabled. ≥ 5.0 |
| layout                | [Layout](https://vega.github.io/vega/docs/config/#legends-layout) | An object specifying layout parameters for positioning a collection of legends with the same *orient* value. ≥ 5.0 |
| legendX               |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The pixel x-coordinate of the legend group. Only applied if the *orient* value is `"none"`. ≥ 5.4 |
| legendY               |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The pixel y-coordinate of the legend group. Only applied if the *orient* value is `"none"`. ≥ 5.4 |
| offset                |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Offset in pixels of the legend from the chart body. If specified, this value will override any values specified in the [legend layout config](https://vega.github.io/vega/docs/config/#legends-layout). |
| orient                |   [String](https://vega.github.io/vega/docs/types/#String)   | Default legend orientation (e.g., `"right"` or `"left"`).    |
| padding               |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Padding in pixels between legend border and contents.        |
| rowPadding            |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The vertical padding in pixels between symbol legend entries. |
| strokeColor           |    [Color](https://vega.github.io/vega/docs/types/#Color)    | Border stroke color for the full legend.                     |
| strokeDash            | [Number](https://vega.github.io/vega/docs/types/#Number)[ ]  | Border stroke dash pattern for the full legend.              |
| strokeWidth           |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Border stroke width for the full legend.                     |
| symbolBaseFillColor   |    [Color](https://vega.github.io/vega/docs/types/#Color)    | Default fill color for legend symbols. Only applied if there is no `"fill"` scale color encoding for the legend. |
| symbolBaseStrokeColor |    [Color](https://vega.github.io/vega/docs/types/#Color)    | Default stroke color for legend symbols. Only applied if there is no `"fill"` scale color encoding for the legend. |
| symbolDash            | [Number](https://vega.github.io/vega/docs/types/#Number)[ ]  | Stroke dash of symbol outlines (or `[]` for solid lines). ≥ 5.0 |
| symbolDashOffset      |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The pixel offset at which to start the symbol dash array. ≥ 5.0 |
| symbolDirection       |   [String](https://vega.github.io/vega/docs/types/#String)   | The default direction (`"horizontal"` or `"vertical"`) for symbol legends. |
| symbolFillColor       |    [Color](https://vega.github.io/vega/docs/types/#Color)    | Fill color for legend symbols.                               |
| symbolLimit           |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The maximum number of allowed entries for a symbol legend. If the number of entries exceeds the limit, entries will be dropped and replaced with an ellipsis. ≥ 5.7 |
| symbolOffset          |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Horizontal pixel offset for legend symbols.                  |
| symbolOpacity         |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Opacity of legend symbols. ≥ 4.1                             |
| symbolSize            |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Default symbol area size (in pixels2).                       |
| symbolStrokeColor     |    [Color](https://vega.github.io/vega/docs/types/#Color)    | Stroke color for legend symbols.                             |
| symbolStrokeWidth     |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Default legend symbol stroke width.                          |
| symbolType            |   [String](https://vega.github.io/vega/docs/types/#String)   | Default shape type (such as `"circle"`) for legend symbols.  |
| tickCount             | [Number](https://vega.github.io/vega/docs/types/#Number) \| [String](https://vega.github.io/vega/docs/types/#String) \| [Object](https://vega.github.io/vega/docs/types/#Object) | The desired number of tick values for quantitative legends. For scales of type `time` or `utc`, the tick count can instead be a time interval specifier. Legal string values are `"millisecond"`, `"second"`, `"minute"`, `"hour"`, `"day"`, `"week"`, `"month"`, and `"year"`. Alternatively, an object-valued interval specifier of the form `{"interval": "month", "step": 3}` includes a desired number of interval steps. Here, ticks are generated for each quarter (Jan, Apr, Jul, Oct) boundary. ≥ 5.7 |
| titleAlign            |   [String](https://vega.github.io/vega/docs/types/#String)   | Horizontal text alignment of legend titles. One of `"left"`, `"center"`, or `"right"`. If specified, this value overrides automatic alignment based on the *titleOrient* and *titleAnchor* values. |
| titleAnchor           |   [String](https://vega.github.io/vega/docs/types/#String)   | The anchor position for placing legend titles. One of `"start"`, `"middle"`, `"end"`, or `null` (default, for automatic determination). For example, with a *titleOrient* of `"top"` these anchor positions map to a left-, center-, or right-aligned title relative to the legend contents. ≥ 5.0 |
| titleBaseline         |   [String](https://vega.github.io/vega/docs/types/#String)   | Vertical text baseline of legend titles. If specified, this value overrides the automatic baseline based on the *titleOrient* and *titleAnchor* values. |
| titleColor            |    [Color](https://vega.github.io/vega/docs/types/#Color)    | Text color of legend titles.                                 |
| titleFont             |   [String](https://vega.github.io/vega/docs/types/#String)   | Font name of legend titles.                                  |
| titleFontSize         |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Font size in pixels of legend titles.                        |
| titleFontStyle        |   [String](https://vega.github.io/vega/docs/types/#String)   | Font style of legend titles (e.g., `normal` or `italic`). ≥ 5.0 |
| titleFontWeight       | [String](https://vega.github.io/vega/docs/types/#String) \| [Number](https://vega.github.io/vega/docs/types/#Number) | Font weight for legend titles.                               |
| titleLimit            |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The maximum allowed length in pixels of legend titles.       |
| titleLineHeight       |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Line height in pixels for multi-line title text. ≥ 5.7       |
| titleOpacity          |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Opacity of legend titles. ≥ 4.1                              |
| titleOrient           |   [String](https://vega.github.io/vega/docs/types/#String)   | The orientation of title legends, determining where they are placed relative to legend contents. One of `"top"` (default), `"left"`, `"bottom"`, or `"right"`. ≥ 5.0 |
| titlePadding          |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Padding in pixels between the legend title and entries.      |

### Legend Layout Properties

具有相同“orient”值的图例集合被放置在一起，或垂直或水平排列。legend layout属性允许自定义如何在Vega视图中组织legends。layout属性是一个对象值，它可以包含应用于所有图例的顶级属性和一组特定于图例的属性，用于定制特定的图例方向。

| Property  |                            Type                            | Description                                                  |
| :-------- | :--------------------------------------------------------: | :----------------------------------------------------------- |
| anchor    |  [String](https://vega.github.io/vega/docs/types/#String)  | An anchor value determining the placement of the legends relative to the nearest axis. One of `"start"` (default), `"middle"`, or `"end"`. For example, for legends with *orient* `"top"`, these values respectively correspond to anchoring the legends to the left edge, center, or right edge of the charting area. This property only applies to axes with an *orient* value of `"left"`, `"right"`, `"top"`, or `"bottom"`. |
| bounds    |  [String](https://vega.github.io/vega/docs/types/#String)  | The type of bounding box calculation to use for calculating legend extents. One of `"flush"` (the default, for using legend width and height values only) or `"full"` (to use the full bounding box, for example including border stroke widths). |
| center    | [Boolean](https://vega.github.io/vega/docs/types/#Boolean) | A boolean flag (default `false`) indicating if legends should be centered within the respective layout area. For example, given a vertical direction, two legends will share a left edge by default. If *center* is true, the smaller legends will be centered in the space spanned by all the legends. |
| direction |  [String](https://vega.github.io/vega/docs/types/#String)  | The direction in which subsequent legends should be spatially positioned. One of `"horizontal"` or `"vertical"`. |
| margin    |  [Number](https://vega.github.io/vega/docs/types/#Number)  | Margin, in pixels, to place between consecutive legends with the same *orient* value. |
| offset    |  [Number](https://vega.github.io/vega/docs/types/#Number)  | Offset, in pixels, of the legend from the chart body.        |

除了这些顶级属性外，图例布局还可以包含除“none”之外的任何法定legend orient值的子对象(包含上面列出的相同属性):`"left"`, `"right"`, `"top"`, `"bottom"`, `"top-left"`, `"top-right"`, `"bottom-left"`, `"bottom-right"`.

**注意**:默认配置包括“左”和“右”方向的图例布局项。如果在顶层添加自定义布局参数，则不会覆盖更具体的配置。如果你想要修改面向“左”或“右”的图例的布局，使用一个针对这些方向的特定子对象。

##### 用法

```js
{
  "legend": {
    "padding": 10,
    "legendStrokeColor": "#ccc",
    "legendStrokeWidth": 1
  }
}
```

### Title Properties

定义标题默认设置的属性。这些属性是在配置对象中的“title”属性下定义的。

| Property           |                             Type                             | Description                                                  |
| :----------------- | :----------------------------------------------------------: | :----------------------------------------------------------- |
| align              |   [String](https://vega.github.io/vega/docs/types/#String)   | Horizontal text alignment of the title and subtitle. If specified, this value overrides automatic alignment based on the *anchor* value. |
| anchor             |   [String](https://vega.github.io/vega/docs/types/#String)   | Title and subtitle anchor position (`"start"`, `"middle"`, or `"end"`). |
| angle              |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Angle in degrees of the title and subtitle text.             |
| baseline           |   [String](https://vega.github.io/vega/docs/types/#String)   | Vertical text baseline of the title and subtitle.            |
| color              |    [Color](https://vega.github.io/vega/docs/types/#Color)    | Text color of the title text.                                |
| dx                 |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Horizontal offset added to the title and subtitle x-coordinate. ≥ 5.2 |
| dy                 |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Vertical offset added to the title and subtitle y-coordinate. ≥ 5.2 |
| font               |   [String](https://vega.github.io/vega/docs/types/#String)   | Font name of the title text.                                 |
| fontSize           |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Font size in pixels of the title text.                       |
| fontStyle          |   [String](https://vega.github.io/vega/docs/types/#String)   | Font style of the title text (e.g., `normal` or `italic`). ≥ 5.0 |
| fontWeight         | [String](https://vega.github.io/vega/docs/types/#String) \| [Number](https://vega.github.io/vega/docs/types/#Number) | Font weight for title text.                                  |
| frame              |   [String](https://vega.github.io/vega/docs/types/#String)   | The reference frame for the anchor position, one of `"bounds"` (to anchor relative to the full bounding box) or `"group"` (to anchor relative to the group width or height). |
| limit              |   [Number](https://vega.github.io/vega/docs/types/#Number)   | The maximum allowed length in pixels of title and subtitle text. |
| lineHeight         |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Line height in pixels for multi-line title text. ≥ 5.7       |
| offset             |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Offset in pixels of the title from the chart body and axes.  |
| orient             |   [String](https://vega.github.io/vega/docs/types/#String)   | Default title orientation (`"top"`, `"bottom"`, `"left"`, or `"right"`). |
| subtitleColor      |    [Color](https://vega.github.io/vega/docs/types/#Color)    | Text color of the subtitle text. ≥ 5.7                       |
| subtitleFont       |   [String](https://vega.github.io/vega/docs/types/#String)   | Font name of the subtitle text. ≥ 5.7                        |
| subtitleFontSize   |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Font size in pixels of the subtitle text. ≥ 5.7              |
| subtitleFontStyle  |   [String](https://vega.github.io/vega/docs/types/#String)   | Font style of the subtitle text (e.g., `normal` or `italic`). ≥ 5.7 |
| subtitleFontWeight | [String](https://vega.github.io/vega/docs/types/#String) \| [Number](https://vega.github.io/vega/docs/types/#Number) | Font weight for subtitle text. ≥ 5.7                         |
| subtitleLineHeight |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Line height in pixels for multi-line subtitle text. ≥ 5.7    |
| subtitlePadding    |   [Number](https://vega.github.io/vega/docs/types/#Number)   | Padding in pixels between title and subtitle text. ≥ 5.7     |

##### 用法

```js
{
  "title": {
    "offset": 10,
    "fontSize": 18
  }
}
```

### Projection Properties

如果没有显式地包含在输入JSON规范中，则应用于制图投影的默认属性。任何合法的投影属性可能包括在内。这些属性是在配置对象的“"projection”属性下定义的。此属性的常见用法是设置默认投影类型。

##### 用法

```js
  "projection": {
    "type": "equalEarth"
  }
}
```

### Scale Range Properties

定义可在范围范围定义内使用的命名范围数组的属性(例如{“type”:“ordinal”，“range”:“category”})。这些属性是在配置对象的“range”属性下定义的。

对象值属性必须是合法的范围定义。

| Property  |                             Type                             | Description                                                  |
| :-------- | :----------------------------------------------------------: | :----------------------------------------------------------- |
| category  | [Scheme](https://vega.github.io/vega/docs/schemes) \| [Color](https://vega.github.io/vega/docs/types/#Color)[ ] | Default [color scheme](https://vega.github.io/vega/docs/schemes) for categorical data. |
| diverging | [Scheme](https://vega.github.io/vega/docs/schemes) \| [Color](https://vega.github.io/vega/docs/types/#Color)[ ] | Default [color scheme](https://vega.github.io/vega/docs/schemes) for diverging quantitative ramps. |
| heatmap   | [Scheme](https://vega.github.io/vega/docs/schemes) \| [Color](https://vega.github.io/vega/docs/types/#Color)[ ] | Default [color scheme](https://vega.github.io/vega/docs/schemes) for quantitative heatmaps. |
| ordinal   | [Scheme](https://vega.github.io/vega/docs/schemes) \| [Color](https://vega.github.io/vega/docs/types/#Color)[ ] | Default [color scheme](https://vega.github.io/vega/docs/schemes) for rank-ordered data. |
| ramp      | [Scheme](https://vega.github.io/vega/docs/schemes) \| [Color](https://vega.github.io/vega/docs/types/#Color)[ ] | Default [color scheme](https://vega.github.io/vega/docs/schemes) for sequential quantitative ramps. |
| symbol    | [String](https://vega.github.io/vega/docs/types/#String)[ ]  | Array of [symbol](https://vega.github.io/vega/docs/marks/symbol) names or paths for the default shape palette. |

##### 用法

这个例子设置了新的默认调色板。

```js
{
  "range": {
    "category": [
      "#5079a5",
      "#ef8e3b",
      "#dd565c",
      "#79b7b2",
      "#5da052",
      "#ecc853",
      "#ad7aa1",
      "#ef9ba7",
      "#9b7461",
      "#bab0ac"
    ],
    "ordinal": {"scheme": "greens"},
    "ramp": {"scheme": "purples"}
  }
}
```

### Signal Definitions

配置文件还可以包含Vega规范的顶级范围的信号定义。语法与标准信号定义相同:一个命名信号对象数组。向配置中添加信号定义对于定义样式变量(颜色、字体大小等)很有用，这些变量可以在配置或规范本身的其他地方使用。在规范中直接定义的信号优先于在配置中定义的信号。

要启用字体大小的动态缩放，可以为字体大小缩放因子定义一个信号，然后定义与此值相关的其他配置项:

```js
{
  "signals": [
    {"name": "fontSizeScale", "value": 1}
  ],
  "text": {
    "fontSize": {"signal": "11 * fontSizeScale"}
  }
}
```

# Data

数据集定义和转换定义要加载的数据以及如何处理这些数据。

Vega使用的基本数据模型是表格数据，类似于电子表格或数据库表。假设各个数据集包含一组记录(或“行”)，其中可能包含任意数量的命名数据属性(字段或“列”)。记录使用标准的JavaScript对象建模。

如果输入数据只是原始值的数组，那么Vega将每个值映射到新对象的数据属性。例如[5,3,8,1]加载为:

```js
[ {"data": 5}, {"data": 3}, {"data": 8}, {"data": 1} ]
```

在摄取数据时，Vega还为每个数据对象分配一个惟一的id属性，可以通过自定义符号进行访问。因此，id属性不能通过字符串键访问，也不可枚举，不过在JavaScript控制台中检查数据对象时可以观察id值。

可以通过内联定义数据或提供用于加载数据的URL来直接指定数据集。另外，可以在运行时动态绑定数据，方法是在图表实例化或发布流更新时使用视图API提供数据。从URL加载数据将取决于您的运行时环境的策略(例如，跨源请求规则)。

## Data Properties

指定数据集的属性。最多定义一个源、url或值属性。

| Property  |                             Type                             | Description                                                  |
| :-------- | :----------------------------------------------------------: | :----------------------------------------------------------- |
| name      |   [String](https://vega.github.io/vega/docs/types/#String)   | **必需的**。数据集的唯一名称。                               |
| format    |   [Format](https://vega.github.io/vega/docs/data/#format)    | 指定数据文件或值的解析格式的对象。有关更多信息，请参见[格式参考](https://vega.github.io/vega/docs/data/#format) |
| source    | [String](https://vega.github.io/vega/docs/types/#String) \| [String](https://vega.github.io/vega/docs/types/#String)[ ] | 要用作此数据集的源的一个或多个数据集的名称。源属性与转换管道结合使用可以派生新数据。如果是字符串值，则指示源数据集的名称。如果是数组值，则指定应该合并(联合)在一起的数据源名称集合。 |
| url       |   [String](https://vega.github.io/vega/docs/types/#String)   | 用于加载数据集的URL。使用format属性确保已加载的数据被正确解析。如果没有指定format属性，则假定数据是面向行的JSON格式。 |
| values    |      [Any](https://vega.github.io/vega/docs/types/#Any)      | 完整的数据集，包括内联。values属性允许数据直接包含在规范本身中。虽然最常见的是对象数组，但是根据格式设置，可能会使用其他数据类型(如CSV字符串)。 |
| async     |  [Boolean](https://vega.github.io/vega/docs/types/#Boolean)  | 一个布尔标志(默认为false)，指示是否异步地进行动态数据加载或重新格式化。如果为真，则将完成数据流评估，数据加载将在后台发生，加载完成后将重新评估数据流。如果为false，数据流计算将阻塞，直到加载完成，然后在相同的计算周期内继续。异步的使用可以允许同时加载多个动态数据集，同时还支持交互性。然而，异步的使用可能导致数据集保持空，而其余的数据流是空的 |
| on        |   [Trigger](https://vega.github.io/vega/docs/triggers)[ ]    | 一个更新数组，用于在满足触发器条件时插入、删除和切换数据值，或清除数据。有关更多信息，请参见[触发器引用](https://vega.github.io/vega/docs/triggers) |
| transform | [Transform](https://vega.github.io/vega/docs/transforms)[ ]  | 要对输入数据执行的转换数组。转换管道的输出将成为此数据集的值。有关更多信息，请参见[转换参考资料](https://vega.github.io/vega/docs/transforms) |

### 动态数据加载

对于4.2版或更高版本，数据url参数和(与url加载一起使用时)格式参数可能包括信号引用。该特性允许在运行时动态更改源url或一个或多个格式化参数，从而导致重新加载数据。例如，单个规范可能基于用户输入加载不同的数据集，或者数据可能与计时器事件流一起定期轮询。

如果没有使用信号(传统的配置)，外部数据源在视图构建后立即加载，并且第一次数据流评估延迟到数据加载完成时。对于动态加载，首先必须对数据流进行评估，以确定信号值，然后才能加载数据。因此，下游转换和编码最初可能使用空数据集进行评估:确保任何信号表达式使用空数据时都表现得适当，包括下游关注的问题，如空标度域。

## Data Formats

format对象描述数据格式和其他解析指令。

| Name  |                             Type                             | Description                                                  |
| :---- | :----------------------------------------------------------: | :----------------------------------------------------------- |
| type  |   [String](https://vega.github.io/vega/docs/types/#String)   | 数据格式类型。当前支持的数据格式有json(默认格式)、csv(逗号分隔值)、tsv(选项卡分隔值)、dsv(分隔文本文件)和topojson。 |
| parse | [String](https://vega.github.io/vega/docs/types/#String) \| [Object](https://vega.github.io/vega/docs/types/#Object) | 如果设置为auto，则执行自动类型推断以确定所需的数据类型。另外，可以为显式数据类型提供解析指令对象。对象的每个属性对应一个字段名，值对应所需的数据类型(“boolean”、“date”、“number”或“string”中的一个)。例如，“parse”:{“modified_on”:“date”}将每个输入记录中的modified_on字段解析为一个日期值。可以使用d3-time格式语法提供特定的日期格式(例如，{"foo": "date:'%m%d%Y'"})。UTC日期格式解析也得到了类似的支持(例如，{"foo": " UTC: " |

### json

加载一个JavaScript对象标记(JSON)文件。假设是面向行的数据，其中每一行都是一个具有命名属性的对象。这是默认的文件格式，如果没有提供格式参数，就会使用这种格式。如果指定，format参数的类型属性应该是“json”，也可以接受以下内容:

| Name     |                            Type                            | Description                                                  |
| :------- | :--------------------------------------------------------: | :----------------------------------------------------------- |
| property |  [String](https://vega.github.io/vega/docs/types/#String)  | 包含所需数据的JSON属性。当加载的JSON文件可能具有周围结构或元数据时，可以使用此参数。例如“property”:“values”。特性”等同于检索json.values。来自加载的JSON对象的特性。 |
| copy     | [Boolean](https://vega.github.io/vega/docs/types/#Boolean) | 一个布尔标志(默认为false)，指示是否应该在使用之前复制输入JSON数据。在提供不应该修改的输入预解析JSON数据(例如，不从URL加载)时，此设置可能很有用。 |

### csv

加载逗号分隔值(CSV)文件。

| Name   |                            Type                             | Description                                                  |
| :----- | :---------------------------------------------------------: | :----------------------------------------------------------- |
| header | [String](https://vega.github.io/vega/docs/types/#String)[ ] | 一个字段名数组，在数据前面加上一个标题行。只有在输入数据还不包含头时，才应该提供头。 |

### tsv

加载一个用制表符分隔的值(TSV)文件。

| Name   |                            Type                             | Description                                                  |
| :----- | :---------------------------------------------------------: | :----------------------------------------------------------- |
| header | [String](https://vega.github.io/vega/docs/types/#String)[ ] | 一个字段名数组，在数据前面加上一个标题行。只有在输入数据还不包含头时，才应该提供头。 |

### dsv

使用自定义分隔符加载带分隔符的文本文件。

| Name      |                            Type                             | Description                                                  |
| :-------- | :---------------------------------------------------------: | :----------------------------------------------------------- |
| delimiter |  [String](https://vega.github.io/vega/docs/types/#String)   | **必需的**。记录之间的分隔符。分隔符必须是单个字符(即，单个16位代码单元);因此，ASCII分隔符是可以的，但是emoji分隔符不行。 |
| header    | [String](https://vega.github.io/vega/docs/types/#String)[ ] | 一个字段名数组，在数据前面加上一个标题行。只有在输入数据还不包含头时，才应该提供头。 |

### topojson

使用TopoJSON格式加载JavaScript对象标记(JSON)文件。输入文件必须包含有效的TopoJSON数据。然后将TopoJSON输入转换为GeoJSON格式，以便在Vega中使用。有两个互斥属性可以用来指定转换过程:

| Name     |                            Type                            | Description                                                  |
| :------- | :--------------------------------------------------------: | :----------------------------------------------------------- |
| feature  |  [String](https://vega.github.io/vega/docs/types/#String)  | 要转换为GeoJSON特性集合的TopoJSON对象的名称。例如，在世界地图中，可能有一个名为“countries”的对象集。使用feature属性，我们可以提取这个集合并为每个国家生成一个GeoJSON特性对象。 |
| mesh     |  [String](https://vega.github.io/vega/docs/types/#String)  | 设置为转换为网格的TopoJSON对象的名称。与feature选项类似，mesh提取一个命名的TopoJSON对象集。与feature选项不同，相应的地理数据是作为一个单独的、统一的mesh实例返回的，而不是作为单独的GeoJSON特性返回的。提取网格对于更有效地绘制边界或其他地理元素非常有用，您不需要将它们与特定区域(如单个国家、州或县)相关联。 |
| filter   |  [String](https://vega.github.io/vega/docs/types/#String)  | 一个可选的过滤器应用到一个提取的网格。如果设置为`"interior"`，只包括内部区域边界，过滤掉外部边界。如果设置为`"exterior"`，只包括外部边界，过滤掉所有内部边界。如果为`"null`"或未指定(默认值)，则不执行筛选。此属性仅适用于网格提取，不适用于特征提取。≥5.4 |
| property |  [String](https://vega.github.io/vega/docs/types/#String)  | 包含所需数据的JSON属性。与type=json类似，当加载的TopoJSON数据具有周围结构或元数据时，可以使用此可选参数。 |
| copy     | [Boolean](https://vega.github.io/vega/docs/types/#Boolean) | 一个布尔标志(默认为false)，指示是否应该在使用之前复制输入JSON数据。与type=json类似，在提供不应该修改的输入预解析json数据(例如，不从URL加载)时，此设置可能很有用。 |

## Examples

下面是一个直接在规范中定义数据的例子:

```js
{"name": "table", "values": [12, 23, 47, 6, 52, 19]}
```

还可以从外部文件(在本例中是JSON文件)加载数据:

```js
{"name": "points", "url": "data/points.json"}
```

或者，可以简单地声明数据集的存在。然后，在实例化可视化时动态地提供数据。有关更多信息，请参见[View API](https://vega.github.io/vega/docs/api/view) 文档。

```js
{"name": "table"}
```

最后，可以从现有的数据集中提取和应用新的数据转换。在这种情况下，我们通过计算来自源`"tabel"`数据集的组的汇总统计信息来创建一个新的数据集(“stats”):

```js
{
  "name": "stats",
  "source": "table",
  "transform": [
    {
      "type": "aggregate",
      "groupby": ["x"],
      "ops": ["average", "sum", "min", "max"],
      "fields": ["y", "y", "y", "y"]
    }
  ]
}
```

# Transforms

转换处理数据流以过滤数据、计算新字段或派生新数据流。转换通常在数据定义的`transform`数组中指定。此外，不过滤或不生成新数据对象的转换可以在标记定义的`transform`数组中使用，以指定后编码转换。

下面的例子定义了一个新的数据集，通过转换来过滤值，然后计算一个堆叠的布局(例如，对于一个堆叠的柱状图):

```js
js{
  "data": [
    {
      "name": "table",
      "transform": [
        { "type": "filter", "expr": "datum.value > 5" },
        { "type": "stack", "field": "value", "groupby": ["category"] }
      ]
    }
  ]
}
```

所有转换都需要一个type属性，指定转换的名称。作为副作用产生值的转换(特别是bin、区段和交叉过滤器转换)可以包含一个信号属性，以指定一个惟一的信号名称，将转换的状态值绑定到该名称。如需查看更多，[点击此处](https://vega.github.io/vega/docs/transforms/)

# Triggers

触发器允许在满足特定条件时对数据集或标记项进行动态更新。当触发器表达式(通常引用一个或多个信号)计算为一个真实值时，将应用一个或多个数据更新(插入、删除、切换和/或修改)。

触发器既可以用于更新数据集中的数据对象，也可以用于更新标记定义中的标记项的属性(仅修改)。

## Trigger Object Properties

| Property |                             Type                             | Description                                                  |
| :------- | :----------------------------------------------------------: | :----------------------------------------------------------- |
| trigger  |  [Expression](https://vega.github.io/vega/docs/expressions)  | **必需的**。定义触发器条件的表达式。当这个表达式被求值并返回一个真值时，触发器条件将被满足，并应用数据更新。 |
| insert   |  [Expression](https://vega.github.io/vega/docs/expressions)  | 求值为要插入的数据对象的表达式。插入操作只适用于数据集，不适用于标记。 |
| remove   | [Expression](https://vega.github.io/vega/docs/expressions) \| [Boolean](https://vega.github.io/vega/docs/types/#Boolean) | 计算要删除的数据对象的表达式。或者，如果布尔值为true，则指示应该删除所有现有的数据对象。删除操作只适用于数据集，不适用于标记。 |
| toggle   |  [Expression](https://vega.github.io/vega/docs/expressions)  | 计算要切换的数据对象的表达式。切换对象的插入或删除取决于它们是否已经在数据集中。切换操作只适用于数据集，不适用于标记。 |
| modify   |  [Expression](https://vega.github.io/vega/docs/expressions)  | 求值为要修改的数据对象的表达式。修改操作同时适用于数据集和标记。如果指定了modify，也必须指定values属性。 |
| values   |  [Expression](https://vega.github.io/vega/docs/expressions)  | 求值为名称-值对的对象的表达式，指示修改表达式返回的数据对象应更新的字段值。 |

## 用法

根据shift-click交互来更新所选项目的数据集。如果在单击事件期间按下了shift键，并且单击的信号引用了与单击的标记项相对应的数据对象，则信号移位指示。(注意，这些示例中没有给出信号定义。)如果单击事件发生而shift键未按下，则删除所有选中的项。如果在没有shift键的情况下点击了一个标记项，那么它的数据对象就会被添加到数据集中。如果在按shift键的时候点击了一个标记项，那么它的数据对象就会被切换。

```js
"data": [
  ...
  {
    "name": "selected",
    "on": [
      {"trigger": "!shift", "remove": true},
      {"trigger": "!shift && clicked", "insert": "clicked"},
      {"trigger": "shift && clicked", "toggle": "clicked"}
    ]
  }
]
```

将`dragged`信号所引用的标记项上的fx和fy属性设置为当前鼠标位置:

```js
{
  "type": "symbol",
  "from": {"data": "nodes"},
  "encode": {...},
  "on": [
    {
      "trigger": "dragged",
      "modify":  "dragged",
      "values":  "{fx: x(), fy: y()}"
    }
  ]
}
```